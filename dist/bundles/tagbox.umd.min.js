!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("into-pipes"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","into-pipes","@angular/common"],t):t(e.tagbox={},e.ng.core,e.intoPipes,e.ng.common)}(this,function(e,i,t,n){"use strict";var s={disabled:1,appendOnDrop:2,prependOnDrop:3,swapOnDrop:4};s[s.disabled]="disabled",s[s.appendOnDrop]="appendOnDrop",s[s.prependOnDrop]="prependOnDrop",s[s.swapOnDrop]="swapOnDrop";var o={viewOnly:1,addOnly:2,removeOnly:4,addAndRemove:6};o[o.viewOnly]="viewOnly",o[o.addOnly]="addOnly",o[o.removeOnly]="removeOnly",o[o.addAndRemove]="addAndRemove";var r={disabled:1,multiSelect:2,singleSelect:3};r[r.disabled]="disabled",r[r.multiSelect]="multiSelect",r[r.singleSelect]="singleSelect";var a=function(){function e(e,t){this.renderer=e,this.el=t,this._tags=[],this._selectedindex=[],this.onchange=new i.EventEmitter,this.onselect=new i.EventEmitter,this.beforeAction=function(e){return!0},this.placeholder="Add Tag"}return e.prototype.ngOnInit=function(){var t=this;this.selectedindex&&this.selectedindex instanceof String&&this.tags&&!(this.tags instanceof String)?(e=String(this.selectedindex)).split(",").map(function(e){t._selectedindex.push(parseInt(e))}):this._selectedindex=this.selectedindex?this.selectedindex:[];if(!this.tags||this.tags instanceof Array)this._tags=this.tags;else{var e=String(this.tags);this._tags=e.split(this.delineateby?this.delineateby:",")}this.renderer.setElementAttribute(this.el.nativeElement,"role","list")},e.prototype.ngOnChanges=function(e){},e.prototype.itemSelectedAt=function(e){var t=this.selectionpolicy!==r.disabled;return!(this._selectedindex.indexOf(e)<0)&&t},e.prototype.itemSelectionClass=function(e){return this.itemSelectedAt(e)?"selected":e<0||this.selectionpolicy===r.disabled?"left-padded":""},e.prototype.isRemovable=function(){var e=this.editpolicy===o.addAndRemove;return e=(e=e||this.editpolicy===o.removeOnly)&&(!this.mintags||this._tags.length>this.mintags)},e.prototype.isDuplicate=function(e){return!(this._tags.indexOf(e)<0)},e.prototype.allowedToaddItem=function(e){var t=this.editpolicy===o.addAndRemove;(t=(t=(t=t||this.editpolicy===o.addOnly)&&(!this.maxtags||this._tags.length<this.maxtags-1))&&!this.isDuplicate(e.name))&&this.maxtaglength&&(this._tags.join(this.delineateby?this.delineateby:",").length+e.name.length+1>=this.maxboxlength?(t=!1,this.renderer.setElementClass(this.el.nativeElement,"alert",!0)):this.renderer.setElementClass(this.el.nativeElement,"alert",!1));return t},e.prototype.notifyChange=function(){this.tags=this.tags instanceof Array?this._tags:this._tags.join(this.delineateby?this.delineateby:","),this.selectedindex=this.selectedindex instanceof Array?this._selectedindex.length?this._selectedindex.join(","):"":this._selectedindex,this.onchange.emit({id:this.id,tags:this.tags,selecedIndex:this.selectedindex})},e.prototype.notifySelection=function(){this.selectedindex=this.selectedindex instanceof Array?this._selectedindex.length?this._selectedindex.join(","):"":this._selectedindex,this.onselect.emit({id:this.id,selecedIndex:this.selectedindex})},e.prototype.onTagRemove=function(e){if(this.isRemovable()&&this.beforeAction({request:"remove",item:e.name})){var t=this._tags.indexOf(e.name),n=this._selectedindex.indexOf(t);this._tags.splice(t,1),0<=n&&(this._selectedindex.splice(n,1),this.notifyChange())}},e.prototype.onTagAdd=function(e){var t=this._tags.indexOf(e.name);this._selectedindex.indexOf(t);t<0&&e.name.length&&this.allowedToaddItem(e)&&this.beforeAction({request:"add",item:e.name})?(this._tags.push(e.name),e.name="",this.notifyChange(),e.click(null)):e.reset()},e.prototype.onTagChange=function(e){if(!this.isDuplicate(e.name)&&this.beforeAction({request:"change",item:e.originalName,to:e.name})){var t=this._tags.indexOf(e.originalName);this._tags[t]=e.name,e.init(),this.notifyChange()}else e.reset()},e.prototype.onTagDrop=function(e){var t=this._tags.indexOf(e.source),n=this._tags.indexOf(e.destination);if(this.dragpolicy===s.appendOnDrop){var i=this._selectedindex.indexOf(t),o=e.destination+" "+e.source;(!this.maxtaglength||this.maxtaglength&&o.length<=this.maxtaglength)&&this.beforeAction({request:"drop",action:"append",source:e.source,destination:e.destination})&&(this._tags[n]=o,this._tags.splice(t,1),this._selectedindex.splice(i,1),this.notifyChange())}else if(this.dragpolicy===s.prependOnDrop){i=this._selectedindex.indexOf(t),o=e.source+" "+e.destination;(!this.maxtaglength||this.maxtaglength&&o.length<=this.maxtaglength)&&this.beforeAction({request:"drop",action:"prepend",source:e.source,destination:e.destination})&&(this._tags[n]=o,this._tags.splice(t,1),this._selectedindex.splice(i,1),this.notifyChange())}this.dragpolicy===s.swapOnDrop&&this.beforeAction({request:"drop",action:"swap",source:e.source,destination:e.destination})&&(this._tags[t]=this._tags.splice(n,1,this._tags[t])[0],this.notifyChange())},e.prototype.onTagSelect=function(e){if(this.selectionpolicy!==r.disabled&&(this.onTagFocus(e),this.beforeAction({request:"select",item:e.name})))if(this.selectionpolicy===r.singleSelect){for(var t=this.el.nativeElement.childNodes,n=0;n<t.length;n++)3!==t[n].nodeType&&8!==t[n].nodeType&&this.renderer.setElementClass(t[n],"selected",!1);if(0<=(i=this._tags.indexOf(e.name)))(n=this._selectedindex.indexOf(i))<0?(this.renderer.setElementClass(e.el.nativeElement,"selected",!0),this._selectedindex=[i]):(this.renderer.setElementClass(e.el.nativeElement,"selected",!1),this._selectedindex=[]),this.notifySelection()}else{var i;if(0<=(i=this._tags.indexOf(e.name)))(n=this._selectedindex.indexOf(i))<0?(this.renderer.setElementClass(e.el.nativeElement,"selected",!0),this._selectedindex.push(i)):(this.renderer.setElementClass(e.el.nativeElement,"selected",!1),this._selectedindex.splice(n,1)),this.notifySelection()}},e.prototype.onTagFocus=function(e){if(this.selectionpolicy!==r.disabled){for(var t=this.el.nativeElement.childNodes,n=0;n<t.length;n++)3!==t[n].nodeType&&8!==t[n].nodeType&&this.renderer.setElementClass(t[n],"focused",!1);0<=this._tags.indexOf(e.name)&&this.renderer.setElementClass(e.el.nativeElement,"focused",!0)}},e}();a.decorators=[{type:i.Component,args:[{selector:"tagbox",template:'\n<tag theme\n    *ngFor="let t of _tags; let i=index"\n    tabindex="0"\n    [class]="itemSelectionClass(i)"\n    [name]="t"\n    [removable]="isRemovable()"\n    [maxlength]="maxtaglength"\n    [format]="format"\n    [autocomplete]="autocomplete"\n    [attr.role]="\'listitem\'"\n    [selectionpolicy]="selectionpolicy"\n    [editpolicy]="editpolicy"\n    [dragpolicy]="dragpolicy"\n    (ondrop)="onTagDrop($event)"\n    (onchange)="onTagChange($event)"\n    (onadd)="onTagAdd($event)"\n    (onremove)="onTagRemove($event)"\n    (onselect)="onTagSelect($event)"\n    (onfocus)="onTagFocus($event)">\n</tag><tag theme\n    placeholder\n    tabindex="0"\n    name=""\n    [class]="itemSelectionClass(-1)"\n    [maxlength]="maxtaglength"\n    [placeholder]="placeholder"\n    [format]="format"\n    [autocomplete]="autocomplete"\n    [attr.role]="\'listitem\'"\n    [selectionpolicy]="selectionpolicy"\n    [editpolicy]="editpolicy"\n    [dragpolicy]="dragpolicy"\n    (ondrop)="onTagDrop($event)"\n    (onchange)="onTagChange($event)"\n    (onadd)="onTagAdd($event)"\n    (onremove)="onTagRemove($event)"\n    (onfocus)="onTagFocus($event)"></tag>\n',styles:[":host{\n  background-color:#fff;\n  border:1px inset #888;\n  -webkit-box-sizing:border-box;\n  box-sizing:border-box;\n  display:inline-block;\n  min-height:50px;\n  padding:5px;\n  width:100%;\n  border-radius:5px;\n  margin-bottom:5px; }\n  :host.alert{\n    background-color:#ff9f9b;\n    border-color:#880500; }\n:host:focus{\n  border-color:#0ba; }\n:host:hover{\n  background-color:#ddd; }\n"]}]}],a.ctorParameters=function(){return[{type:i.Renderer},{type:i.ElementRef}]},a.propDecorators={onchange:[{type:i.Output,args:["onchange"]}],onselect:[{type:i.Output,args:["onselect"]}],beforeAction:[{type:i.Input,args:["beforeAction"]}],id:[{type:i.Input,args:["id"]}],placeholder:[{type:i.Input,args:["placeholder"]}],maxboxlength:[{type:i.Input,args:["maxboxlength"]}],maxtaglength:[{type:i.Input,args:["maxtaglength"]}],maxtags:[{type:i.Input,args:["maxtags"]}],mintags:[{type:i.Input,args:["mintags"]}],tags:[{type:i.Input,args:["tags"]}],selectedindex:[{type:i.Input,args:["selectedindex"]}],delineateby:[{type:i.Input,args:["delineateby"]}],format:[{type:i.Input,args:["format"]}],autocomplete:[{type:i.Input,args:["autocomplete"]}],selectionpolicy:[{type:i.Input,args:["selectionpolicy"]}],editpolicy:[{type:i.Input,args:["editpolicy"]}],dragpolicy:[{type:i.Input,args:["dragpolicy"]}]};var l=function(){function e(e,t,n){this.into=e,this.el=t,this.renderer=n,this.selectedFiller=-1,this.onfocus=new i.EventEmitter,this.onchange=new i.EventEmitter,this.onselect=new i.EventEmitter,this.onremove=new i.EventEmitter,this.onadd=new i.EventEmitter,this.ondrop=new i.EventEmitter}return e.prototype.ngOnInit=function(){this.init(),this.el.nativeElement.draggable=this.dragpolicy!==s.disabled},e.prototype.dragStart=function(e){e.stopPropagation(),this.allowDrag()&&e.dataTransfer.setData("source",this.name)},e.prototype.drag=function(e){},e.prototype.dragEnd=function(e){e.stopPropagation(),this.renderer.setElementClass(this.el.nativeElement,"drag-over",!1)},e.prototype.drop=function(e){e.preventDefault(),this.renderer.setElementClass(this.el.nativeElement,"drag-over",!1),this.ondrop.emit({source:e.dataTransfer.getData("source"),destination:this.name})},e.prototype.dragEnter=function(e){e.preventDefault(),this.allowDrop(e)?this.renderer.setElementClass(this.el.nativeElement,"drag-over",!0):this.renderer.setElementClass(this.el.nativeElement,"drag-over",!1)},e.prototype.dragLeave=function(e){e.preventDefault(),this.renderer.setElementClass(this.el.nativeElement,"drag-over",!1)},e.prototype.dragOver=function(e){this.allowDrop(e)?(e.preventDefault(),this.renderer.setElementClass(this.el.nativeElement,"drag-over",!0)):this.renderer.setElementClass(this.el.nativeElement,"drag-over",!1)},e.prototype.allowDrop=function(e){var t=e.dataTransfer.getData("source");return t&&t!=this.name&&this.name&&0<this.name.length},e.prototype.allowDrag=function(){return this.dragpolicy!==s.disabled&&this.name&&0<this.name.length},e.prototype.keyup=function(e){var t=this;if(e.target===this.el.nativeElement||this.editor&&e.target===this.editor.nativeElement)13===(n=e.which)?this.click(e):9===n&&this.editMode?setTimeout(function(){t.editMode=!1,t.originalName.length&&t.originalName!==t.name?t.onchange.emit(t):t.onadd.emit(t)},66):38===n?this.filler&&(0<=this.selectedFiller?this.selectedFiller--:this.selectedFiller=this.fillerList.length-1):40===n&&this.filler&&(this.selectedFiller<this.fillerList.length-1?this.selectedFiller++:this.selectedFiller=-1);else if(this.selector&&e.target===this.selector.nativeElement){13===(n=e.which)&&this.isSelectable()&&this.onselect.emit(this)}else{var n;13===(n=e.which)&&this.remove()}},e.prototype.click=function(e){var t=this;this.selector&&e.target===this.selector.nativeElement?this.isSelectable()&&this.onselect.emit(this):this.isEditable()&&(this.editMode=!this.editMode,this.editMode?setTimeout(function(){t.filler&&(t.selectedFiller=-1,t.updateFillerList(t.name)),t.editor&&(t.editor.nativeElement.focus(),t.filler&&t.renderer.setElementClass(t.filler.nativeElement,"off",!1))},66):0<=this.selectedFiller&&(this.name=this.fillerList[this.selectedFiller]),this.originalName.length?(this.originalName!==this.name&&this.onchange.emit(this),this.editMode||setTimeout(function(){t.el.nativeElement.focus()},66)):this.onadd.emit(this))},e.prototype.focus=function(e){this.isSelectable()&&this.onfocus.emit(this)},e.prototype.isRemovable=function(){var e=this.editpolicy===o.addAndRemove;return e=e||this.editpolicy===o.removeOnly},e.prototype.isEditable=function(){return this.editpolicy!==o.viewOnly},e.prototype.isDraggable=function(){return this.dragpolicy!==s.disabled},e.prototype.isSelectable=function(){return this.selectionpolicy!==r.disabled},e.prototype.select=function(){},e.prototype.tabout=function(e){var t=this;setTimeout(function(){t.name=t.selectedFiller<0?e.target.value:t.fillerList[t.selectedFiller],t.editMode=!1,t.originalName.length&&t.originalName!==t.name?t.onchange.emit(t):t.onadd.emit(t)},66)},e.prototype.edit=function(e){this.name=e.target.value,this.updateFillerList(this.name)},e.prototype.updateFillerList=function(t){t&&this.autocomplete instanceof Array&&t&&(this.fillerList=this.autocomplete.filter(function(e){return 0<=e.indexOf(t)}))},e.prototype.init=function(){this.originalName=this.name},e.prototype.reset=function(){this.name=this.originalName},e.prototype.remove=function(){this.isRemovable()&&this.onremove.emit(this)},e.prototype.formattedName=function(){var e=this.name;return this.format&&(e=this.into.transform(this.name,this.format)),e},e}();l.decorators=[{type:i.Component,args:[{selector:"tag",template:'\n<span #selector\n    *ngIf="!editMode && removable && isSelectable()"\n    tabindex="0"\n    class="selection fa"\n    (click)="select()"></span>\n<input\n    *ngIf="editMode"\n    class="editor"\n    (blur)="tabout($event)"\n    (keyup)="edit($event)"\n    [value]="name"\n    [attr.maxlength]="maxlength"\n    [attr.placeholder]="placeholder" #editor/>\n<div class="autocomplete off" *ngIf="editMode && autocomplete" #filler>\n  <ul>\n      <li *ngFor="let x of fillerList; let i = index"\n        (click)="selectedFiller = i"\n        [class.selected]="selectedFiller === i"\n        [textContent]="x"></li>\n  </ul>\n</div>\n<span\n    *ngIf="!editMode"\n    class="holder"\n    [innerHTML]="placeholder ? placeholder : formattedName()"></span>\n<span\n    *ngIf="!editMode && removable"\n    tabindex="0"\n    class="remove fa fa-times"\n    (click)="remove()"></span>\n<span\n    *ngIf="!removable"\n    class="placeholder fa fa-plus-circle"></span>',styles:[':host{\n  cursor:pointer;\n  color:#fdfdfd;\n  margin:4px 2px;\n  display:inline-block;\n  background-color:#1F84AB;\n  border:1px solid #015E85;\n  border-radius:8px 20px 20px 8px;\n  -webkit-box-sizing:border-box;\n          box-sizing:border-box;\n  padding:3px 0;\n  position:relative; }\n  :host ::ng-deep img{\n    width:50px; }\n  :host.left-padded{\n    padding-left:8px; }\n  :host.drag-over:hover{\n    background-color:#add8e6;\n    cursor:move; }\n  :host[placeholder]{\n    background-color:transparent;\n    color:#000;\n    border:0; }\n    :host[placeholder]:hover{\n      background-color:#eee !important; }\n    :host[placeholder] .editor{\n      color:#000; }\n  :host:hover{\n    background-color:#027912 !important;\n    border-color:#024b0b !important; }\n  :host.focused{\n    background-color:#027912 !important;\n    border-color:#024b0b !important; }\n  :host.selected:hover{\n    background-color:#D6534E; }\n  :host.selected{\n    background-color:#D6534E; }\n    :host.selected .selection.fa:before{\n      content:"\\f00c" !important; }\n  :host .selection{\n    background-color:transparent;\n    float:left;\n    margin-right:3px;\n    padding:0;\n    width:10px;\n    height:10px;\n    font-size:0.8rem;\n    padding:5px 3px; }\n    :host .selection.fa:before{\n      content:"\\f013"; }\n  :host .editor{\n    background-color:transparent;\n    overflow:unset;\n    max-width:inherit;\n    width:inherit;\n    color:#fff;\n    border:none; }\n  :host .placeholder{\n    color:#888585;\n    float:right;\n    font-size:1rem;\n    height:20px;\n    line-height:20px;\n    margin-left:5px;\n    text-align:center;\n    width:20px; }\n  :host .remove{\n    float:right;\n    font-size:0.7rem;\n    height:20px;\n    width:20px;\n    color:#fff;\n    text-align:center;\n    margin-left:5px;\n    line-height:20px;\n    font-weight:bolder; }\n  :host .holder{\n    pointer-events:none;\n    -webkit-user-select:none;\n    -moz-user-select:none;\n    -ms-user-select:none;\n    user-select:none; }\n  :host .autocomplete{\n    position:absolute;\n    top:26px;\n    z-index:5; }\n    :host .autocomplete.off{\n      display:none; }\n    :host .autocomplete ul{\n      border:1px solid #024b0b;\n      border-top:0;\n      list-style:none;\n      background-color:#027912;\n      list-style-position:inside;\n      margin:0;\n      max-height:150px;\n      overflow-y:auto;\n      padding:0; }\n      :host .autocomplete ul li{\n        color:#fdfdfd;\n        padding:5px;\n        white-space:nowrap; }\n        :host .autocomplete ul li.selected{\n          background-color:#D6534E; }\n        :host .autocomplete ul li:hover{\n          background-color:#0446a8;\n          color:#fff; }\n']}]}],l.ctorParameters=function(){return[{type:t.InToPipe},{type:i.ElementRef},{type:i.Renderer}]},l.propDecorators={onfocus:[{type:i.Output,args:["onfocus"]}],onchange:[{type:i.Output,args:["onchange"]}],onselect:[{type:i.Output,args:["onselect"]}],onremove:[{type:i.Output,args:["onremove"]}],onadd:[{type:i.Output,args:["onadd"]}],ondrop:[{type:i.Output,args:["ondrop"]}],format:[{type:i.Input,args:["format"]}],removable:[{type:i.Input,args:["removable"]}],maxlength:[{type:i.Input,args:["maxlength"]}],name:[{type:i.Input,args:["name"]}],placeholder:[{type:i.Input,args:["placeholder"]}],autocomplete:[{type:i.Input,args:["autocomplete"]}],selectionpolicy:[{type:i.Input,args:["selectionpolicy"]}],editpolicy:[{type:i.Input,args:["editpolicy"]}],dragpolicy:[{type:i.Input,args:["dragpolicy"]}],editor:[{type:i.ViewChild,args:["editor"]}],selector:[{type:i.ViewChild,args:["selector"]}],filler:[{type:i.ViewChild,args:["filler"]}],dragStart:[{type:i.HostListener,args:["dragstart",["$event"]]}],drag:[{type:i.HostListener,args:["drag",["$event"]]}],dragEnd:[{type:i.HostListener,args:["dragend",["$event"]]}],drop:[{type:i.HostListener,args:["drop",["$event"]]}],dragEnter:[{type:i.HostListener,args:["dragenter",["$event"]]}],dragLeave:[{type:i.HostListener,args:["dragleave",["$event"]]}],dragOver:[{type:i.HostListener,args:["dragover",["$event"]]}],keyup:[{type:i.HostListener,args:["keyup",["$event"]]}],click:[{type:i.HostListener,args:["click",["$event"]]}],focus:[{type:i.HostListener,args:["focus",["$event"]]}]};var d=function(){};d.decorators=[{type:i.NgModule,args:[{imports:[n.CommonModule,t.IntoPipeModule],declarations:[a,l],exports:[a],entryComponents:[],providers:[],schemas:[i.CUSTOM_ELEMENTS_SCHEMA]}]}],d.ctorParameters=function(){return[]},e.TagBoxComponent=a,e.DragDropPolicy=s,e.EditPolicy=o,e.Selectionpolicy=r,e.TagBoxModule=d,e.ɵa=l,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=tagbox.umd.min.js.map
